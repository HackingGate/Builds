language: minimal
branches:
  only:
  - master
addons:
  apt:
    packages:
    - tree
env:
  global:
  - REPO=Downloads
  - LC_ALL=C.UTF-8
script:
- git config --add remote.origin.fetch '+refs/heads/*:refs/remotes/origin/*'
- git fetch origin gh-pages
- git checkout gh-pages
- git checkout master -- RevealServer.sh
- ./RevealServer.sh && rm RevealServer.sh
- sha256sum -b */*.zip */*.bin > sha256sums.txt
- tree -H '.' -h --noreport --charset utf-8 -T $REPO -o index.html
- cat github-corner.html >> index.html
- sed -i "s/your-url/github.com\/${GH_USER}\/${REPO}/g" index.html
deploy:
  provider: pages
  skip_cleanup: true
  github_token: ${GH_TOKEN}
  keep_history: false
